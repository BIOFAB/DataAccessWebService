<!DOCTYPE html><html><head><title>Sencha Documentation Project</title><link rel="stylesheet" href="../reset.css" type="text/css"><link rel="stylesheet" href="../prettify.css" type="text/css"><link rel="stylesheet" href="http://localhost:3000/new/css/prettify_sa.css" type="text/css"><script type="text/javascript" src="../prettify.js"></script></head><body onload="prettyPrint()"><pre class="prettyprint"><pre><a name="cls-Ext.DataView"></a>/**
 * A mechanism for displaying data using custom layout templates and formatting. DataView uses an {@link Ext.XTemplate}
 * as its internal templating mechanism, and is bound to an {@link Ext.data.Store}
 * so that as the data in the store changes the view is automatically updated to reflect the changes.  The view also
 * provides built-in behavior for many common events that can occur for its contained items including click, doubleclick,
 * mouseover, mouseout, etc. as well as a built-in selection model. &lt;b&gt;In order to use these features, an {@link #itemSelector}
 * config must be provided for the DataView to determine what nodes it will be working with.&lt;/b&gt;
 *
 * &lt;p&gt;The example below binds a DataView to a {@link Ext.data.Store} and renders it into an {@link Ext.panel.Panel}.&lt;/p&gt;
 * <br><span style="display: none">**/</span>Ext.regModel(&#39;Image&#39;, {
    fields: [
        &#39;name&#39;, &#39;url&#39;,
        {name:&#39;size&#39;, type: &#39;float&#39;},
        {name:&#39;lastmod&#39;, type:&#39;date&#39;, dateFormat:&#39;timestamp&#39;}
    ]
});
var store = new Ext.data.Store({
    autoLoad: true,
    model: &#39;Image&#39;,
    proxy: {
        type: &#39;ajax&#39;,
        url: &#39;get-images.php&#39;,,
        reader: {
            type: &#39;json&#39;,
            root: &#39;images&#39;
        }
    }
    fields: [
        &#39;name&#39;, &#39;url&#39;,
        {name:&#39;size&#39;, type: &#39;float&#39;},
        {name:&#39;lastmod&#39;, type:&#39;date&#39;, dateFormat:&#39;timestamp&#39;}
    ]
});
var tpl = new Ext.XTemplate(
    &#39;&amp;lt;tpl for=&quot;.&quot;&amp;gt;&#39;,
        &#39;&amp;lt;div class=&quot;thumb-wrap&quot; id=&quot;{name}&quot;&amp;gt;&#39;,
        &#39;&amp;lt;div class=&quot;thumb&quot;&amp;gt;&amp;lt;img src=&quot;{url}&quot; title=&quot;{name}&quot;&amp;gt;&amp;lt;/div&amp;gt;&#39;,
        &#39;&amp;lt;span class=&quot;x-editable&quot;&amp;gt;{shortName}&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&#39;,
    &#39;&amp;lt;/tpl&amp;gt;&#39;,
    &#39;&amp;lt;div class=&quot;x-clear&quot;&amp;gt;&amp;lt;/div&amp;gt;&#39;
);

var panel = new Ext.panel.Panel({
    renderTo: document.body,
    frame:true,
    width:535,
    height: 400,
    layout:&#39;fit&#39;,
    title:&#39;Simple DataView&#39;,

    items: new Ext.DataView({
        store: store,
        tpl: tpl,
        itemSelector:&#39;div.thumb-wrap&#39;,
        emptyText: &#39;No images to display&#39;
    })
});
 * <br><span style="display: none">/**</span> * @class Ext.DataView
 * @extends Ext.AbstractDataView
 * @xtype dataview
 */
Ext.define(&#39;Ext.DataView&#39;, {
    extend: &#39;Ext.AbstractDataView&#39;,
    alias: &#39;widget.dataview&#39;,
    addCmpEvents: function() {
        this.addEvents(
            <a name="event-Ext.DataView-beforeclick"></a>/**
             * @event beforeclick
             * Fires before a click is processed. Returns false to cancel the default action.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            &#39;beforeclick&#39;,

            <a name="event-Ext.DataView-click"></a>/**
             * @event click
             * Fires when a template node is clicked.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            &#39;click&#39;,

            <a name="event-Ext.DataView-mouseenter"></a>/**
             * @event mouseenter
             * Fires when the mouse enters a template node. trackOver:true and an overItemCls must be set to enable this event.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            &#39;mouseenter&#39;,

            <a name="event-Ext.DataView-mouseleave"></a>/**
             * @event mouseleave
             * Fires when the mouse leaves a template node. trackOver:true and an overItemCls must be set to enable this event.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            &#39;mouseleave&#39;,

            <a name="event-Ext.DataView-containerclick"></a>/**
             * @event containerclick
             * Fires when a click occurs and it is not on a template node.
             * @param {Ext.DataView} this
             * @param {Ext.EventObject} e The raw event object
             */
            &#39;containerclick&#39;,

            <a name="event-Ext.DataView-dblclick"></a>/**
             * @event dblclick
             * Fires when a template node is double clicked.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            &#39;dblclick&#39;,

            <a name="event-Ext.DataView-contextmenu"></a>/**
             * @event contextmenu
             * Fires when a template node is right clicked.
             * @param {Ext.DataView} this
             * @param {Number} index The index of the target node
             * @param {HTMLElement} node The target node
             * @param {Ext.EventObject} e The raw event object
             */
            &#39;contextmenu&#39;,

            <a name="event-Ext.DataView-containercontextmenu"></a>/**
             * @event containercontextmenu
             * Fires when a right click occurs that is not on a template node.
             * @param {Ext.DataView} this
             * @param {Ext.EventObject} e The raw event object
             */
            &#39;containercontextmenu&#39;,

            <a name="event-Ext.DataView-selectionchange"></a>/**
             * @event selectionchange
             * Fires when the selected nodes change. Relayed event from the underlying selection model.
             * @param {Ext.DataView} this
             * @param {Array} selections Array of the selected nodes
             */
            &#39;selectionchange&#39;,

            <a name="event-Ext.DataView-beforeselect"></a>/**
             * @event beforeselect
             * Fires before a selection is made. If any handlers return false, the selection is cancelled.
             * @param {Ext.DataView} this
             * @param {HTMLElement} node The node to be selected
             * @param {Array} selections Array of currently selected nodes
             */
            &#39;beforeselect&#39;
        );
    },
    // private
    afterRender: function(){
        var me = this, 
            listeners = {
                scope: me,
                click: me.onClick,
                dblclick: me.onDblClick,
                contextmenu: me.onContextMenu
            };
        
        me.callParent();

        if (me.overItemCls &amp;&amp; me.trackOver) {
            Ext.apply(listeners, {
                mouseover: me.onMouseOver,
                mouseout: me.onMouseOut
            });
        }
        
        me.mon(me.getTargetEl(), listeners);
        if (me.store) {
            me.bindStore(me.store, true);
        }
    },

    // private
    onClick: function(e){
        var me = this,
            item = e.getTarget(me.itemSelector, me.getTargetEl()),
            index;

        if (item) {
            index = me.indexOf(item);
            if (me.onItemClick(item, index, e) !== false) {
                me.fireEvent(&#39;click&#39;, me, index, item, e);
            }
        } else {
            if(me.fireEvent(&#39;containerclick&#39;, me, e) !== false){
                me.onContainerClick(e);
            }
        }
    },
    
    // @private, template method
    onContainerClick: Ext.emptyFn,

    // private
    onContextMenu : function(e){
        var me = this,
            item = e.getTarget(me.itemSelector, me.getTargetEl());
            
        if (item) {
            me.fireEvent(&#39;contextmenu&#39;, me, me.indexOf(item), item, e);
        } else {
            me.fireEvent(&#39;containercontextmenu&#39;, me, e);
        }
    },

    // private
    onDblClick: function(e){
        var me = this,
            item = e.getTarget(me.itemSelector, me.getTargetEl());
            
        if (item) {
            me.fireEvent(&#39;dblclick&#39;, me, me.indexOf(item), item, e);
        }
    },

    // private
    onMouseOver: function(e){
        var me = this,
            item = e.getTarget(me.itemSelector, me.getTargetEl());
            
        if (item &amp;&amp; item !== me.highlightedItem) {
            me.highlightItem(item);
            me.fireEvent(&#39;mouseenter&#39;, me, me.indexOf(item), item, e);
        }
    },

    // private
    onMouseOut : function(e){
        var me = this,
            highlighted = me.highlightedItem;
            
        if (highlighted) {
            if (!e.within(highlighted, true, true)) {
                me.clearHighlight();
                me.fireEvent(&#39;mouseleave&#39;, me, me.indexOf(highlighted), highlighted, e);
            }
        }
    },

    <a name="method-Ext.DataView-highlightItem"></a>/**
     * Highlight a given item in the DataView. This is called by the mouseover handler if {@link #overItemCls}
     * and {@link #trackOver} are configured, but can also be called manually by other code, for instance to
     * handle stepping through the list via keyboard navigation.
     * @param {HTMLElement} item The item to highlight
     */
    highlightItem: function(item) {
        var me = this;
        me.clearHighlight();
        me.highlightedItem = item;
        Ext.fly(item).addCls(me.overItemCls);
    },

    <a name="method-Ext.DataView-clearHighlight"></a>/**
     * Un-highlight the currently highlighted item, if any.
     */
    clearHighlight: function() {
        var me = this,
            highlighted = me.highlightedItem;
            
        if (highlighted) {
            Ext.fly(highlighted).removeCls(me.overItemCls);
            delete me.highlightedItem;
        }
    },

    // private
    onItemClick: function(item, index, e){
        if (this.fireEvent(&#39;beforeclick&#39;, this, index, item, e) === false) {
            return false;
        }
        return true;
    }
});￿</pre></pre></body></html>